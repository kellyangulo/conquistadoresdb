'use strict'

const sql = require('./')
const Mocha = require('mocha')
const path = require('path')

async function main () {
  // try {
  const mocha = new Mocha()
  mocha.addFile(path.join(__dirname, './mocha-test.js'))
  await new Promise((resolve, reject) => {
    mocha.run((failures) => {
      if (failures) {
        console.log('failed');
        reject(new Error('Test failed'))
      } else {
        console.log('resolved');
        resolve('Test pass')
      }
    })
  });
  console.log('process finished');
  //   const pool = new sql.ConnectionPool({
  //     user: 'sa',
  //     password: 'Upper_l0wercase',
  //     server: 'localhost',
  //     database: 'di_production',
  //   });
  //   const conn = await pool.connect();
  //   const request = new sql.Request(conn);
  //   const values = [
  //     'AFG',
  //     'ALA',
  //     'ALB',
  //     'GBR',
  //   ];
  //   const result = await request.query`SELECT * FROM countries WHERE countryCode in (${values});`;
  //   console.log(result.recordset);
  // } catch (err) {
  //   console.error(err);
  //   process.exit(1);
  // }
  // process.exit(0);
}

main()
